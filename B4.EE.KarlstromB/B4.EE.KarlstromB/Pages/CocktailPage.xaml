<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:d="http://xamarin.com/schemas/2014/forms/design"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:bhv="clr-namespace:B4.EE.KarlstromB.Behaviors"   
             xmlns:numeric="clr-namespace:Syncfusion.SfNumericUpDown.XForms;assembly=Syncfusion.SfNumericUpDown.XForms"
             xmlns:inputLayout="clr-namespace:Syncfusion.XForms.TextInputLayout;assembly=Syncfusion.Core.XForms"
             mc:Ignorable="d"
             Title="{Binding PageTitle}"
             x:Name="page"             
             x:Class="B4.EE.KarlstromB.Pages.CocktailPage">
    <ContentPage.ToolbarItems>
        <ToolbarItem Text="Save" 
                     IconImageSource="{OnPlatform UWP=save.png}" 
                     Command="{Binding SaveCocktailCommand}" />
    </ContentPage.ToolbarItems>
    <ContentPage.Content>
        <ScrollView>
            <Grid BackgroundColor="{OnPlatform Android=#FFFFFF, UWP=#FECDFF}">
                <Grid.RowDefinitions>
                    <RowDefinition Height="200" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="50" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Frame Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="2" VerticalOptions="CenterAndExpand" HorizontalOptions="CenterAndExpand" BorderColor="#FD77FF" BackgroundColor="White" Padding="5" WidthRequest="175">
                    <StackLayout>
                        <Image Source="{Binding ImageUrl}" HeightRequest="150" HorizontalOptions="Center" />
                        <StackLayout Orientation="Horizontal" HorizontalOptions="Center">
                            <ImageButton Command="{Binding TakePhotoCommand}" HeightRequest="25" BackgroundColor="Transparent">
                                <ImageButton.Source>
                                    <OnPlatform x:TypeArguments="ImageSource">
                                        <On Platform="Android">camera.png</On>
                                        <On Platform="UWP">Images/camera.png</On>
                                    </OnPlatform>
                                </ImageButton.Source>
                            </ImageButton>
                            <ImageButton Command="{Binding UploadPhotoCommand}" HeightRequest="25" BackgroundColor="Transparent">
                                <ImageButton.Source>
                                    <OnPlatform x:TypeArguments="ImageSource">
                                        <On Platform="Android">upload.png</On>
                                        <On Platform="UWP">Images/upload.png</On>
                                    </OnPlatform>
                                </ImageButton.Source>
                            </ImageButton>
                        </StackLayout>
                    </StackLayout>
                </Frame>
                <StackLayout Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="4"  VerticalOptions="CenterAndExpand" HorizontalOptions="FillAndExpand" BackgroundColor="White" >
                    <BoxView BackgroundColor="{OnPlatform Android=#34B3D9, UWP=#FD77FF}" HeightRequest="10"/>
                    <StackLayout Padding="50,25,50,25">
                        <inputLayout:SfTextInputLayout Hint="Name"
                                                   FocusedColor="#E240E3"
                                                   UnfocusedColor="Silver">
                            <Entry Text="{Binding CocktailName}" Placeholder="Name your cocktail here"/>
                        </inputLayout:SfTextInputLayout>
                        <Label Text="{Binding CocktailNameError}"
                           IsVisible="{Binding CocktailNameErrorVisible}" 
                           StyleClass="errormessage" />
                        <inputLayout:SfTextInputLayout Hint="Preparation"
                                                   FocusedColor="#E240E3"
                                                   UnfocusedColor="Silver">
                            <Editor Text="{Binding CocktailPreparation}" AutoSize="TextChanges" Placeholder="Describe the preparation here" />
                        </inputLayout:SfTextInputLayout>
                        <Label Text="{Binding CocktailPreparationError}"
                           IsVisible="{Binding CocktailPreparationErrorVisible}" 
                           StyleClass="errormessage" />
                    </StackLayout>
                    <BoxView BackgroundColor="{OnPlatform Android=#34B3D9, UWP=#FD77FF}" HeightRequest="10"/>
                    <StackLayout Orientation="Horizontal" Padding="10,25,10,25">
                        <StackLayout HorizontalOptions="CenterAndExpand">
                            <Label Text="Rating" FontSize="Medium"/>
                            <numeric:SfNumericUpDown Value="{Binding Rating}" Minimum="1" Maximum="10" SpinButtonAlignment="Both" IsEditable="False" BackgroundColor="#F5F5F5"/>
                        </StackLayout>
                        <StackLayout HorizontalOptions="CenterAndExpand">
                            <StackLayout Orientation="Horizontal">
                                <Label Text="Ingredients" FontSize="Medium"/>
                                <ImageButton Command="{Binding OpenIngredientPageCommand}" HeightRequest="25" BackgroundColor="Transparent">
                                    <ImageButton.Source>
                                        <OnPlatform x:TypeArguments="ImageSource">
                                            <On Platform="Android">newingredient.png</On>
                                            <On Platform="UWP">Images/newingredient.png</On>
                                        </OnPlatform>
                                    </ImageButton.Source>
                                </ImageButton>
                            </StackLayout>
                            <Frame Padding="10" Margin="10" BorderColor="#34B3D9" HasShadow="True" HeightRequest="100">
                                <ListView ItemsSource="{Binding Ingredients}"
                              HasUnevenRows="False" RowHeight="30">
                                    <ListView.Behaviors>
                                        <bhv:EventToCommandBehavior 
                                EventName="ItemTapped"  
                                Command="{Binding OpenIngredientPageCommand}"
                                EventArgsConverter="{StaticResource ItemTappedEventArgsConv}" />
                                    </ListView.Behaviors>
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <ViewCell>
                                                <ViewCell.ContextActions>
                                                    <MenuItem Command="{Binding BindingContext.OpenIngredientPageCommand, Source={x:Reference page}}" 
                                                  CommandParameter="{Binding .}" 
                                                  Text="Edit" />
                                                    <MenuItem Command="{Binding BindingContext.DeleteIngredientCommand, Source={x:Reference page}}"
                                                  CommandParameter="{Binding .}"
                                                  Text="Delete" IsDestructive="True" />
                                                </ViewCell.ContextActions>
                                                <StackLayout>
                                                    <StackLayout Orientation="Horizontal">
                                                        <Label Text="{Binding Name}" />
                                                        <Label Text="{Binding Amount, StringFormat='{0} ml'}"/>
                                                    </StackLayout>
                                                </StackLayout>
                                            </ViewCell>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                </ListView>
                            </Frame>
                        </StackLayout>
                    </StackLayout>
                    <BoxView BackgroundColor="{OnPlatform Android=#34B3D9, UWP=#FD77FF}" HeightRequest="10"/>
                </StackLayout>
            </Grid>
        </ScrollView>
    </ContentPage.Content>
</ContentPage>